// ColorBox v1.3.18 - a full featured, light-weight, customizable lightbox based on jQuery 1.3+
// Copyright (c) 2011 Jack Moore - jack@colorpowered.com
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
(function(e,t,n){function Q(n,r,i){var o=t.createElement(n);r&&(o.id=s+r);i&&(o.style.cssText=i);return e(o)}function G(e){var t=T.length,n=(U+e)%t;return n<0?t+n:n}function Y(e,t){return Math.round((/%/.test(e)?(t==="x"?N.width():N.height())/100:1)*parseInt(e,10))}function Z(e){return B.photo||/\.(gif|png|jpe?g|bmp|ico)((#|\?).*)?$/i.test(e)}function et(){var t;B=e.extend({},e.data(R,i));for(t in B)e.isFunction(B[t])&&t.slice(0,2)!=="on"&&(B[t]=B[t].call(R));B.rel=B.rel||R.rel||"nofollow";B.href=B.href||e(R).attr("href");B.title=B.title||R.title;typeof B.href=="string"&&(B.href=e.trim(B.href))}function tt(t,n){e.event.trigger(t);n&&n.call(R)}function nt(){var e,t=s+"Slideshow_",n="click."+s,r,i,o;if(B.slideshow&&T[1]){r=function(){M.text(B.slideshowStop).unbind(n).bind(f,function(){if(U<T.length-1||B.loop)e=setTimeout(J.next,B.slideshowSpeed)}).bind(a,function(){clearTimeout(e)}).one(n+" "+l,i);g.removeClass(t+"off").addClass(t+"on");e=setTimeout(J.next,B.slideshowSpeed)};i=function(){clearTimeout(e);M.text(B.slideshowStart).unbind([f,a,l,n].join(" ")).one(n,function(){J.next();r()});g.removeClass(t+"on").addClass(t+"off")};B.slideshowAuto?r():i()}else g.removeClass(t+"off "+t+"on")}function rt(t){if(!V){R=t;et();T=e(R);U=0;if(B.rel!=="nofollow"){T=e("."+o).filter(function(){var t=e.data(this,i).rel||this.rel;return t===B.rel});U=T.index(R);if(U===-1){T=T.add(R);U=T.length-1}}if(!W){W=X=!0;g.show();if(B.returnFocus)try{R.blur();e(R).one(c,function(){try{this.focus()}catch(e){}})}catch(n){}m.css({opacity:+B.opacity,cursor:B.overlayClose?"pointer":"auto"}).show();B.w=Y(B.initialWidth,"x");B.h=Y(B.initialHeight,"y");J.position();d&&N.bind("resize."+v+" scroll."+v,function(){m.css({width:N.width(),height:N.height(),top:N.scrollTop(),left:N.scrollLeft()})}).trigger("resize."+v);tt(u,B.onOpen);H.add(A).hide();P.html(B.close).show()}J.load(!0)}}var r={transition:"elastic",speed:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,inline:!1,html:!1,iframe:!1,fastIframe:!0,photo:!1,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:!1,returnFocus:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:undefined},i="colorbox",s="cbox",o=s+"Element",u=s+"_open",a=s+"_load",f=s+"_complete",l=s+"_cleanup",c=s+"_closed",h=s+"_purge",p=e.browser.msie&&!e.support.opacity,d=p&&e.browser.version<7,v=s+"_IE6",m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K="div";J=e.fn[i]=e[i]=function(t,n){var s=this;t=t||{};J.init();if(!s[0]){if(s.selector)return s;s=e("<a/>");t.open=!0}n&&(t.onComplete=n);s.each(function(){e.data(this,i,e.extend({},e.data(this,i)||r,t));e(this).addClass(o)});(e.isFunction(t.open)&&t.open.call(s)||t.open)&&rt(s[0]);return s};J.init=function(){if(!g){if(!e("body")[0]){e(J.init);return}N=e(n);g=Q(K).attr({id:i,"class":p?s+(d?"IE6":"IE"):""});m=Q(K,"Overlay",d?"position:absolute":"").hide();y=Q(K,"Wrapper");b=Q(K,"Content").append(C=Q(K,"LoadedContent","width:0; height:0; overflow:hidden"),L=Q(K,"LoadingOverlay").add(Q(K,"LoadingGraphic")),A=Q(K,"Title"),O=Q(K,"Current"),_=Q(K,"Next"),D=Q(K,"Previous"),M=Q(K,"Slideshow").bind(u,nt),P=Q(K,"Close"));y.append(Q(K).append(Q(K,"TopLeft"),w=Q(K,"TopCenter"),Q(K,"TopRight")),Q(K,!1,"clear:left").append(E=Q(K,"MiddleLeft"),b,S=Q(K,"MiddleRight")),Q(K,!1,"clear:left").append(Q(K,"BottomLeft"),x=Q(K,"BottomCenter"),Q(K,"BottomRight"))).find("div div").css({"float":"left"});k=Q(K,!1,"position:absolute; width:9999px; visibility:hidden; display:none");e("body").prepend(m,g.append(y,k));j=w.height()+x.height()+b.outerHeight(!0)-b.height();F=E.width()+S.width()+b.outerWidth(!0)-b.width();I=C.outerHeight(!0);q=C.outerWidth(!0);g.css({"padding-bottom":j,"padding-right":F}).hide();_.click(function(){J.next()});D.click(function(){J.prev()});P.click(function(){J.close()});H=_.add(D).add(O).add(M);m.click(function(){B.overlayClose&&J.close()});e(t).bind("keydown."+s,function(e){var t=e.keyCode;if(W&&B.escKey&&t===27){e.preventDefault();J.close()}if(W&&B.arrowKey&&T[1])if(t===37){e.preventDefault();D.click()}else if(t===39){e.preventDefault();_.click()}})}};J.remove=function(){g.add(m).remove();g=null;e("."+o).removeData(i).removeClass(o)};J.position=function(e,t){function o(e){w[0].style.width=x[0].style.width=b[0].style.width=e.style.width;L[0].style.height=L[1].style.height=b[0].style.height=E[0].style.height=S[0].style.height=e.style.height}var n=0,r=0,i=g.offset();N.unbind("resize."+s);g.css({top:-99999,left:-99999});if(B.fixed&&!d)g.css({position:"fixed"});else{n=N.scrollTop();r=N.scrollLeft();g.css({position:"absolute"})}B.right!==!1?r+=Math.max(N.width()-B.w-q-F-Y(B.right,"x"),0):B.left!==!1?r+=Y(B.left,"x"):r+=Math.round(Math.max(N.width()-B.w-q-F,0)/2);B.bottom!==!1?n+=Math.max(N.height()-B.h-I-j-Y(B.bottom,"y"),0):B.top!==!1?n+=Y(B.top,"y"):n+=Math.round(Math.max(N.height()-B.h-I-j,0)/2);g.css({top:i.top,left:i.left});e=g.width()===B.w+q&&g.height()===B.h+I?0:e||0;y[0].style.width=y[0].style.height="9999px";g.dequeue().animate({width:B.w+q,height:B.h+I,top:n,left:r},{duration:e,complete:function(){o(this);X=!1;y[0].style.width=B.w+q+F+"px";y[0].style.height=B.h+I+j+"px";t&&t();setTimeout(function(){N.bind("resize."+s,J.position)},1)},step:function(){o(this)}})};J.resize=function(e){if(W){e=e||{};e.width&&(B.w=Y(e.width,"x")-q-F);e.innerWidth&&(B.w=Y(e.innerWidth,"x"));C.css({width:B.w});e.height&&(B.h=Y(e.height,"y")-I-j);e.innerHeight&&(B.h=Y(e.innerHeight,"y"));if(!e.innerHeight&&!e.height){C.css({height:"auto"});B.h=C.height()}C.css({height:B.h});J.position(B.transition==="none"?0:B.speed)}};J.prep=function(t){function o(){B.w=B.w||C.width();B.w=B.mw&&B.mw<B.w?B.mw:B.w;return B.w}function u(){B.h=B.h||C.height();B.h=B.mh&&B.mh<B.h?B.mh:B.h;return B.h}if(!W)return;var n,r=B.transition==="none"?0:B.speed;C.remove();C=Q(K,"LoadedContent").append(t);C.hide().appendTo(k.show()).css({width:o(),overflow:B.scrolling?"auto":"hidden"}).css({height:u()}).prependTo(b);k.hide();e(z).css({"float":"none"});d&&e("select").not(g.find("select")).filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one(l,function(){this.style.visibility="inherit"});n=function(){function m(){p&&g[0].style.removeAttribute("filter")}var t,n,o=T.length,u,a="frameBorder",l="allowTransparency",c,d,v;if(!W)return;c=function(){clearTimeout($);L.hide();tt(f,B.onComplete)};p&&z&&C.fadeIn(100);A.html(B.title).add(C).show();if(o>1){typeof B.current=="string"&&O.html(B.current.replace("{current}",U+1).replace("{total}",o)).show();_[B.loop||U<o-1?"show":"hide"]().html(B.next);D[B.loop||U?"show":"hide"]().html(B.previous);B.slideshow&&M.show();if(B.preloading){t=[G(-1),G(1)];while(n=T[t.pop()]){d=e.data(n,i).href||n.href;e.isFunction(d)&&(d=d.call(n));if(Z(d)){v=new Image;v.src=d}}}}else H.hide();if(B.iframe){u=Q("iframe")[0];a in u&&(u[a]=0);l in u&&(u[l]="true");u.name=s+ +(new Date);B.fastIframe?c():e(u).one("load",c);u.src=B.href;B.scrolling||(u.scrolling="no");e(u).addClass(s+"Iframe").appendTo(C).one(h,function(){u.src="//about:blank"})}else c();B.transition==="fade"?g.fadeTo(r,1,m):m()};B.transition==="fade"?g.fadeTo(r,0,function(){J.position(0,n)}):J.position(r,n)};J.load=function(t){var n,r,i=J.prep;X=!0;z=!1;R=T[U];t||et();tt(h);tt(a,B.onLoad);B.h=B.height?Y(B.height,"y")-I-j:B.innerHeight&&Y(B.innerHeight,"y");B.w=B.width?Y(B.width,"x")-q-F:B.innerWidth&&Y(B.innerWidth,"x");B.mw=B.w;B.mh=B.h;if(B.maxWidth){B.mw=Y(B.maxWidth,"x")-q-F;B.mw=B.w&&B.w<B.mw?B.w:B.mw}if(B.maxHeight){B.mh=Y(B.maxHeight,"y")-I-j;B.mh=B.h&&B.h<B.mh?B.h:B.mh}n=B.href;$=setTimeout(function(){L.show()},100);if(B.inline){Q(K).hide().insertBefore(e(n)[0]).one(h,function(){e(this).replaceWith(C.children())});i(e(n))}else if(B.iframe)i(" ");else if(B.html)i(B.html);else if(Z(n)){e(z=new Image).addClass(s+"Photo").error(function(){B.title=!1;i(Q(K,"Error").text("This image could not be loaded"))}).load(function(){var e;z.onload=null;if(B.scalePhotos){r=function(){z.height-=z.height*e;z.width-=z.width*e};if(B.mw&&z.width>B.mw){e=(z.width-B.mw)/z.width;r()}if(B.mh&&z.height>B.mh){e=(z.height-B.mh)/z.height;r()}}B.h&&(z.style.marginTop=Math.max(B.h-z.height,0)/2+"px");if(T[1]&&(U<T.length-1||B.loop)){z.style.cursor="pointer";z.onclick=function(){J.next()}}p&&(z.style.msInterpolationMode="bicubic");setTimeout(function(){i(z)},1)});setTimeout(function(){z.src=n},1)}else n&&k.load(n,B.data,function(t,n,r){i(n==="error"?Q(K,"Error").text("Request unsuccessful: "+r.statusText):e(this).contents())})};J.next=function(){if(!X&&T[1]&&(U<T.length-1||B.loop)){U=G(1);J.load()}};J.prev=function(){if(!X&&T[1]&&(U||B.loop)){U=G(-1);J.load()}};J.close=function(){if(W&&!V){V=!0;W=!1;tt(l,B.onCleanup);N.unbind("."+s+" ."+v);m.fadeTo(200,0);g.stop().fadeTo(300,0,function(){g.add(m).css({opacity:1,cursor:"auto"}).hide();tt(h);C.remove();setTimeout(function(){V=!1;tt(c,B.onClosed)},1)})}};J.element=function(){return e(R)};J.settings=r;e("."+o,t).live("click",function(e){if(!(e.which>1||e.shiftKey||e.altKey||e.metaKey)){e.preventDefault();rt(this)}});J.init()})(jQuery,document,this);